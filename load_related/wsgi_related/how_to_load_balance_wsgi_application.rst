=================================================================
WSGIアプリケーションのロードバランス方法
=================================================================

構成
====

haproxy導入前
-------------

通常のneutron-serverの構成。::

  client -> neutron-server


haproxy導入後
-------------

haproxyを入れた構成::

  client -> haproxy -> neutron-server1
                    -> neutron-server2


結果：haproxy導入前
=====================

パラメタ
------------

多重度パラメタは以下の通り。

==============    =========
パラメタ
---------------------------
api_worker        rpc_worker
==============    =========
2                 2
==============    =========

ツールの多重度は70

結果
-----

70多重を五回実施する。

==============    =========
ツール実行時間
---------------------------
回数              秒
==============    =========
1                 97
2                 102 
3                 90
4                 88
5                 93
==============    =========
  
====  ==============    =========   ==================
port-create処理時間(sec)
------------------------------------------------------
回数  最小              最大        平均
====  ==============    =========   ==================
1     0.280339          1.760895    0.6499535285714285 
2     0.241315          4.960889    0.6751582857142856
3     0.284085          1.882018    0.6068050857142856
4     0.260635          2.352242    0.6897485428571427 
5     0.251930          3.147542    0.7216231571428572
====  ==============    =========   ==================

結果：haproxy導入後
=====================

パラメタ
------------

多重度パラメタは以下の通り。

==============    =========
パラメタ
---------------------------
api_worker        rpc_worker
==============    =========
1                 1
==============    =========

ツールの多重度は70

結果
-----

70多重を五回実施する。

==============    =========
ツール実行時間
---------------------------
回数              秒
==============    =========
1                 78
2                 81 
3                 78 
4                 79 
5                 80 
==============    =========
  
====  ==============    =========   ==================
port-create処理時間(sec)
------------------------------------------------------
回数  最小              最大        平均
====  ==============    =========   ==================
1     0.237386          1.889033    0.5035489000000001  
2     0.229120          1.856221    0.5147663571428571 
3     0.225573          2.971383    0.5631438428571429 
4     0.215520          1.700170    0.5228506714285714 
5     0.239335          1.665960    0.49212662857142847  
====  ==============    =========   ==================



参考：詳細データ
===================

haproxy導入前 1回目
---------------------

0.280339
0.286918
0.322156
0.329363
0.331394
0.334104
0.349608
0.363426
0.368418
0.375111
0.380845
0.387193
0.391748
0.399803
0.403612
0.404136
0.409013
0.410220
0.413506
0.416342
0.423992
0.427598
0.428159
0.430838
0.436754
0.437820
0.438407
0.441392
0.450263
0.453643
0.459296
0.461683
0.466677
0.469723
0.479539
0.488692
0.507077
0.532052
0.558584
0.561168
0.596255
0.600080
0.607248
0.611412
0.710204
0.744596
0.788249
0.805769
0.807593
0.810132
0.811575
0.811615
0.830657
0.837148
0.857732
0.891923
0.915455
0.924413
0.927037
0.952224
0.990168
1.053936
1.102093
1.222517
1.240026
1.263113
1.409281
1.441691
1.461098
1.760895


haproxy導入前 2回目
---------------------

0.241315
0.269461
0.279471
0.284389
0.305710
0.316252
0.325313
0.344734
0.349383
0.349911
0.353028
0.355794
0.362599
0.376140
0.378559
0.393096
0.393536
0.394473
0.395093
0.403814
0.407985
0.408397
0.408834
0.410710
0.413049
0.415954
0.432943
0.436029
0.440991
0.452201
0.453663
0.458088
0.478388
0.482061
0.483454
0.503259
0.514049
0.528474
0.534387
0.537416
0.543695
0.549208
0.572440
0.577620
0.591099
0.607281
0.651003
0.656226
0.670320
0.681494
0.697632
0.700293
0.703876
0.728805
0.751267
0.759645
0.781735
0.808272
0.842263
0.877161
0.927600
1.212759
1.316100
1.345008
1.361126
1.426811
1.435621
1.554220
1.897208
4.960889


haproxy導入前 3回目
---------------------

0.284085
0.301734
0.305078
0.347006
0.348055
0.356003
0.357850
0.359515
0.360420
0.360826
0.377192
0.386082
0.406280
0.410461
0.412843
0.429294
0.430593
0.437042
0.437197
0.439114
0.442268
0.446191
0.448996
0.451767
0.466688
0.469696
0.471392
0.472496
0.476717
0.488741
0.501003
0.519838
0.522252
0.533757
0.535445
0.538070
0.539435
0.540437
0.540810
0.546661
0.550248
0.550777
0.568495
0.577737
0.596487
0.600199
0.600378
0.600613
0.610812
0.649079
0.668074
0.672351
0.693848
0.700437
0.732336
0.761177
0.779461
0.794851
0.804045
0.863291
0.867654
0.871629
0.871689
0.876909
0.944570
0.964946
1.130818
1.414943
1.777154
1.882018


haproxy導入前 4回目
---------------------

0.260635
0.325777
0.328584
0.339527
0.342003
0.346753
0.358017
0.370215
0.373934
0.385724
0.400780
0.400902
0.403245
0.409562
0.411471
0.414459
0.435983
0.441273
0.447410
0.449737
0.452966
0.456695
0.459837
0.467954
0.473560
0.473697
0.474498
0.488278
0.501016
0.507622
0.527980
0.528536
0.541358
0.545136
0.566333
0.581606
0.584845
0.587755
0.602392
0.605781
0.633435
0.667556
0.701361
0.714772
0.725618
0.747728
0.756030
0.761300
0.764558
0.767951
0.770505
0.771707
0.792992
0.830953
0.857587
0.884662
0.904233
0.908007
0.959471
0.964508
0.983380
1.106960
1.160124
1.191023
1.227630
1.342869
1.375083
1.670111
1.914206
2.352242


haproxy導入前 5回目
---------------------

0.251930
0.264542
0.282480
0.301108
0.306056
0.311118
0.335178
0.337027
0.341918
0.351059
0.366694
0.368865
0.369215
0.375784
0.378867
0.405916
0.408067
0.417026
0.422473
0.427898
0.429660
0.430619
0.455312
0.455429
0.463520
0.480668
0.507687
0.520090
0.530614
0.540931
0.543278
0.546124
0.550722
0.551623
0.558182
0.567324
0.584820
0.612091
0.615532
0.634712
0.636926
0.668557
0.676596
0.687191
0.713526
0.715714
0.721746
0.729117
0.754220
0.772049
0.778983
0.789133
0.792857
0.817316
0.881679
0.885528
0.890973
0.911225
0.918119
0.919668
0.980349
1.005858
1.059416
1.104424
1.162683
1.684401
1.827923
2.172906
3.104837
3.147542


haproxy導入後 1回目
---------------------

0.237386
0.243870
0.257198
0.263391
0.267233
0.269521
0.269647
0.272494
0.275101
0.279336
0.281523
0.286277
0.287914
0.288063
0.292101
0.292618
0.293224
0.300417
0.302847
0.310114
0.317875
0.327719
0.334394
0.335883
0.336555
0.339449
0.342269
0.343986
0.353311
0.362337
0.364301
0.364752
0.367937
0.369450
0.372844
0.373835
0.377259
0.380154
0.382842
0.390004
0.399525
0.403854
0.421918
0.432647
0.443125
0.443390
0.459623
0.460008
0.472580
0.481375
0.497729
0.501335
0.543566
0.572467
0.607804
0.619786
0.627639
0.644574
0.765122
0.781521
0.792337
0.796751
0.838214
0.862652
1.071932
1.329341
1.369312
1.417930
1.593902
1.889033


haproxy導入後 2回目
---------------------

0.229120
0.242139
0.261987
0.270439
0.292593
0.302129
0.318610
0.330811
0.336459
0.341768
0.346559
0.346947
0.347787
0.351010
0.355243
0.360227
0.364862
0.370275
0.371291
0.371357
0.375848
0.381394
0.382378
0.385578
0.393171
0.402960
0.407498
0.410273
0.410431
0.411933
0.413550
0.416710
0.424050
0.444349
0.446193
0.447176
0.449458
0.457192
0.466851
0.467363
0.468899
0.493056
0.498606
0.508090
0.517527
0.518790
0.527229
0.533901
0.534109
0.537766
0.538949
0.541675
0.541730
0.559910
0.570511
0.582109
0.588580
0.612369
0.616997
0.637382
0.644418
0.695580
0.698637
0.765054
0.912001
0.934881
0.948968
0.952352
1.791379
1.856221



haproxy導入後 3回目
---------------------

0.225573
0.232888
0.238079
0.251490
0.258743
0.262265
0.267357
0.268562
0.273920
0.275360
0.277418
0.284978
0.309967
0.316627
0.317773
0.319358
0.327494
0.327765
0.328955
0.331893
0.334838
0.337520
0.346800
0.358822
0.360182
0.365501
0.366631
0.371619
0.377028
0.385740
0.387134
0.387621
0.388652
0.388664
0.404124
0.404568
0.409878
0.414529
0.415147
0.416583
0.427875
0.436793
0.442056
0.445097
0.477028
0.483270
0.490148
0.503484
0.521895
0.530839
0.551714
0.572712
0.586783
0.601377
0.647004
0.648301
0.735716
0.806420
0.830089
0.886171
0.894601
0.924791
1.048903
1.055526
1.126477
1.449978
1.548307
1.573043
1.884242
2.971383


haproxy導入後 4回目
---------------------

0.215520
0.253977
0.267762
0.273251
0.273577
0.276608
0.289774
0.297208
0.301713
0.304505
0.305804
0.308503
0.312712
0.314201
0.314510
0.322175
0.333034
0.335310
0.348823
0.349705
0.353613
0.354598
0.363676
0.364615
0.365126
0.365274
0.372005
0.380469
0.385511
0.388592
0.392412
0.397730
0.401060
0.401118
0.401646
0.402413
0.406936
0.408948
0.409171
0.417780
0.421479
0.422641
0.423268
0.440673
0.444678
0.465964
0.469664
0.477108
0.488712
0.493803
0.543443
0.592589
0.603190
0.611153
0.616723
0.703907
0.708329
0.719556
0.745817
0.751606
0.764487
0.782219
0.897834
1.126539
1.148603
1.245984
1.282110
1.319424
1.456509
1.700170


haproxy導入後 5回目
---------------------

0.239335
0.241319
0.249780
0.259156
0.265880
0.268752
0.280632
0.280777
0.282017
0.286686
0.287405
0.289812
0.298700
0.300602
0.315011
0.315496
0.322213
0.322417
0.326826
0.329159
0.340584
0.349853
0.353753
0.362122
0.367072
0.370004
0.381036
0.382721
0.396411
0.405074
0.407510
0.407647
0.407931
0.413388
0.413509
0.419984
0.422926
0.423053
0.424355
0.424871
0.428591
0.429123
0.430015
0.431004
0.432254
0.434990
0.436792
0.463813
0.465689
0.469403
0.487153
0.500152
0.504734
0.522413
0.526839
0.535528
0.557306
0.573930
0.596156
0.710385
0.742271
0.767034
0.794234
0.967320
0.981180
1.005720
1.162955
1.350958
1.439183
1.665960


